{"version":3,"sources":["img/red.png","img/blue.png","img/grass.png","img/silver.png","components/Banner.jsx","game/Comm.js","game/Client.js","components/Footer.jsx","dispatchers/ModalDispatcher.js","dispatchers/NavDispatcher.js","components/Login.jsx","data/Data.js","utils/Ajax.js","components/Register.jsx","data/GameObjects.js","data/MapObjects.js","data/TransportObjects.js","game/Game.js","components/CharacterSelect.jsx","components/CharacterCreate.jsx","components/GameViewChat.jsx","components/GameViewTarget.jsx","components/GameViewPlayer.jsx","components/GameViewAbilities.jsx","components/GameViewDropdown.jsx","components/GameView.jsx","components/AlertModal.jsx","components/App.jsx","index.js"],"names":["module","exports","Banner","_React$Component","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","apply","arguments","inherits","createClass","key","value","react_default","a","createElement","className","src","title","alt","React","Component","OpCode","Status","game_Client","Client","_this","call","socket","clientID","accessLevel","_this2","isConnected","url","window","location","origin","replace","WebSocket","addEventListener","emit","err","evt","handleData","data","toString","_this3","split","forEach","msg","opCode","status","json","JSON","parse","console","log","processResponse","handleLogin","handleLogout","handleCharacterList","handleCharacterCreate","handleMapEnter","handleInstanceEnter","handleChatMessage","handleObjectCreate","handleObjectDelete","handleObjectUpdate","handleObjectStats","handleAbilityList","handleCreateInstance","handleMapPlayers","_data$message","message","_data$clientID","_data$accessLevel","_data$message2","_data$message3","_data$characterList","characterList","_data$message4","_data$message5","_data$mapState","mapState","_data$message6","_data$mapState2","_data$chat","chat","_data$from","from","_data$spawnState","spawnState","_data$objectID","objectID","_data$updateState","updateState","_data$message7","_data$stats","stats","_data$message8","_data$abilityList","abilityList","_data$message9","_data$players","players","username","password","send","version","name","skin","abilityName","instanceName","sendString","stringify","str","readyState","EventEmitter","Footer","dispatchers_ModalDispatcher","header","body","footer","dispatchers_NavDispatcher","menu","showMenu","Login","props","usernameInput","passwordInput","usernameToSave","state","pending","onConnect","setState","onLogin","saveUsername","NavDispatcher","showCharacterSelect","ModalDispatcher","modal","on","getSavedUsername","connect","removeListener","showRegister","preventDefault","login","localStorage","setItem","getItem","Banner_Banner","Form","onSubmit","bind","FormGroup","Label","Input","innerRef","input","type","maxLength","disabled","required","Button","width","onClick","onCreate","Footer_Footer","Ajax","options","Promise","resolve","reject","_options$method","method","_options$headers","headers","_options$query","query","_options$data","xhr","XMLHttpRequest","queryString","open","setRequestHeader","request","parameters","params","param","push","concat","join","Access-Control-Allow-Origin","length","undefined","Access-Control-Allow-Headers","Register","confirmInput","showLogin","getCorsHeaders","post","then","response","clearForm","catch","onCancel","GameObject","_fw$MPGameEntity","imgAlias","height","team","anim","fw","getImageURLByAlias","setNametag","playAnimation","GameObjectFactory","setImageAliasMany","blacksmith","paragon","templar","player","MapTiles","Grass","_fw$Sprite","TILE_SIZE","grass","TransportObject","_fw$GameEntity","nodeID","text","moveSpeed","TransportObjectFactory","airship","defaultFont","game_Game","Game","renderer","layers","objects","keys","collisionGrid","mapBounds","scroller","selectedTarget","onGameFrame","assertThisInitialized","processClick","started","todo","loadAliases","unloadMap","mapData","transportNodes","units","loadAssets","report","errs","images","errors","sounds","gmd","buildMap","tileSize","background","tileLayout","tileTypes","midground","foreground","onKey","toggleMapGrid","tData","createTransportNode","uData","createObject","startRendering","mapSprite","task","stopRendering","removeAll","clear","x","y","spawnLocation","object","addObject","col","row","addAt","add","setPosition","selectTarget","ownerID","playerUpdate","getData","getObjectStats","getAbilityList","_this4","getObject","remove","removeObject","unselectTarget","_this5","updateObject","_data$spawnLocation","tnode","element","injectInto","target","castAbility","numKeys","isKeyDown","moveUp","moveDown","moveLeft","moveRight","depthSort","CharacterSelect","errMessage","onCharacterList","onEnterMap","showGame","loadMap","getCharacterList","showCharacterCreate","logout","selectCharacter","characterListErrMsg","rows","i","characterData","level","last_map","selectPlayer","Table","renderLogoutBtn","onLogout","_this$state","_this$state$character","_this$state$errMessag","renderCharacterList","renderBody","CharacterCreate","nameInput","skinInput","onCharacterCreate","createCharacter","Row","Col","lg","GameViewChat","displayRef","createRef","inputRef","onChatReceived","elem","current","keyCode","chatMessage","ref","readOnly","onKeyUp","onChatSend","GameViewTarget","onObjectStats","base","_stats$level","colSpan","health","toFixed","mana","defense","resistance","renderStats","GameViewPlayer","xp","xpNeeded","GameViewAbilities","onAbilityList","icons","Array","_loop","ability","icon","slice","renderAbilityList","GameViewDropdown","isOpen","onMapPlayers","map","getMapPlayers","DropdownItem","divider","Dropdown","toggle","DropdownToggle","caret","DropdownMenu","onFindPlayers","onExit","renderAdminItems","GameView","containerRef","onObjectCreate","onObjectDelete","onObjectUpdate","GameViewChat_GameViewChat","GameViewTarget_GameViewTarget","GameViewPlayer_GameViewPlayer","GameViewAbilities_GameViewAbilities","GameViewDropdown_GameViewDropdown","AlertModal","onModal","Modal","ModalHeader","ModalBody","ModalFooter","App","onMenu","onClientClose","onClientError","Login_Login","Register_Register","CharacterSelect_CharacterSelect","CharacterCreate_CharacterCreate","GameView_GameView","renderMenu","AlertModal_AlertModal","ReactDOM","render","App_App","document","querySelector"],"mappings":"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","file":"static/js/main.3b9e0bec.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAACWCAYAAAAouC1GAAABcElEQVR4nO3RQQ0AIBDAsAP/nuGNAvZoFSzZOjNnyNi/A3gZEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsRcy7UDKhga1CUAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAACWCAYAAAAouC1GAAABcElEQVR4nO3RQQ0AIBDAsAP/nuGNAvZoFSzZmjlnyNi/A3gZEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsQYEmNIjCExhsRcybcDKgRYUCEAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAADH0lEQVR4nO3UMQEAIAzAsIFY/DsAGRxNFPTqmjN3gKT9OwD4xwAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAgzAAg7AHxPgNloRSyTgAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAACWCAYAAAAouC1GAAABc0lEQVR4nO3RQREAIRDAsOP8S1tP8EYBfSQKOtM1M/sj438dwM2QGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJMaQGENiDIkxJOYAhDIEj9TrJPAAAAAASUVORK5CYII=\"","import React from \"react\";\r\n//import bannerImg from \"../img/banner.png\";\r\n\r\nexport class Banner extends React.Component{\r\n    render(){\r\n        return (\r\n            <div className=\"text-center\">\r\n                <h1>\r\n                    <img\r\n                        src={null}\r\n                        title=\"Fallen Crusade\"\r\n                        alt=\"Fallen Crusade\"\r\n                    />\r\n                </h1>\r\n            </div>\r\n        );\r\n    }\r\n}","/*\r\n    WebSocket communication constants \r\n*/\r\n\r\n// operation codes \r\nexport const OpCode = {\r\n    ACCOUNT_LOGIN:      2,\r\n    ACCOUNT_LOGOUT:     3,\r\n    CHARACTER_LIST:     4,\r\n    CHARACTER_CREATE:   5,\r\n    CHARACTER_SELECT:   6,\r\n    CHARACTER_DELETE:   7,\r\n    ENTER_MAP:          8,\r\n    ENTER_INSTANCE:     9,\r\n    CHAT_MESSAGE:       10,\r\n    OBJECT_CREATE:      11,\r\n    OBJECT_DELETE:      12,\r\n    OBJECT_UPDATE:      13,\r\n    OBJECT_STATS:       14,\r\n    FX_CREATE:          15,\r\n    ABILITY_LIST:       16,\r\n    ABILITY_UPGRADE:    17,\r\n    ABILITY_CAST:       18,\r\n    SKIN_PURCHASE:      19,\r\n    SKIN_CHANGE:        20,\r\n    INVITE_SEND:        21,\r\n    INVITE_NOTIFY:      22,\r\n    INVITE_REPLY:       23,\r\n    INVITE_RESPONSE:    24,\r\n    CREATE_INSTANCE:    25,\r\n    MAP_PLAYERS:        26,\r\n    BAD_REQUEST:        99\r\n}\r\n\r\n// server response status codes \r\nexport const Status = {\r\n    GOOD:   \"ok\",\r\n    BAD:    \"bad\"\r\n};\r\n\r\n// delimiter for message json\r\n// (messages can be sent simulteanously as a concatenated string) \r\nexport const MSG_DELIM = \"?&?\";","import { EventEmitter } from \"events\";\r\nimport { MSG_DELIM, OpCode, Status } from \"./Comm\";\r\n\r\nexport const CLIENT_VERSION = \"0.1.0\";\r\n\r\nclass Client extends EventEmitter{\r\n    constructor(){\r\n        super();\r\n\r\n        this.socket = null;         // the websocket\r\n        this.clientID = null;       // server-assigned ID \r\n        this.accessLevel = 0;       // server-assigned acccess level (commands UI)\r\n    }\r\n\r\n    // creates and connects the weboscket to the game server\r\n    connect(){\r\n        // can only connect if not connected\r\n        if(!this.isConnected){\r\n            // determine game server endpoint\r\n            // connects to current origin but with websocket protocols \r\n            // http=ws and https=wss\r\n            // switch to port 8080 from 3000 (3000 = react server, 8080 = test server)\r\n            let url = window.location.origin\r\n                .replace(\":3000\", \":8080\")\r\n                .replace(\"https://\", \"wss://\")\r\n                .replace(\"http://\", \"ws://\");\r\n\r\n            // create the websocket\r\n            this.socket = new WebSocket(url);\r\n\r\n            // handle websocket connection \r\n            this.socket.addEventListener(\"open\", () => {\r\n                this.emit(\"connect\");\r\n            });\r\n\r\n            // handle websocket error\r\n            this.socket.addEventListener(\"error\", err => {\r\n                this.emit(\"error\", err);\r\n            });\r\n\r\n            // handle websocket data\r\n            this.socket.addEventListener(\"message\", evt => {\r\n                this.handleData(evt.data.toString());\r\n            });\r\n\r\n            // handle websocket close\r\n            this.socket.addEventListener(\"close\", () => {\r\n                this.emit(\"close\");\r\n            });\r\n        }\r\n    }\r\n\r\n    // handles server data by parsing it then processing it (plain text at this point)\r\n    handleData(data){\r\n        // responses can be concatenated - split using delimiter\r\n        data.split(MSG_DELIM).forEach(msg => {\r\n            // each individual response... pepare to extract response parameters\r\n            let opCode, data, status;\r\n\r\n            // attempt to parse json \r\n            try{\r\n                // parse\r\n                let json = JSON.parse(msg);\r\n\r\n                // extract resposne parameters\r\n                // assign defaults if neccessary, but they should always be provided\r\n                opCode =    json.opCode ||  -1;\r\n                data =      json.data   ||  {};\r\n                status =    json.status ||  Status.BAD;\r\n\r\n                // print response (ignore object updates becase those are very frequent)\r\n                if(opCode !== OpCode.OBJECT_UPDATE) console.log(json);\r\n            }\r\n            catch(err){\r\n                // json parse error - skip this update (should never happen)\r\n                return;\r\n            }\r\n\r\n            // server data is now parsed, time to process the response\r\n            this.processResponse(opCode, data, status);\r\n        });\r\n    }\r\n\r\n    // processes the parsed server response data\r\n    processResponse(opCode, data, status){\r\n        // invoke handler based on opCode \r\n        switch(opCode){\r\n            case OpCode.ACCOUNT_LOGIN:\r\n                this.handleLogin(data, status);\r\n                break;\r\n            case OpCode.ACCOUNT_LOGOUT:\r\n                this.handleLogout(data, status);\r\n                break;\r\n            case OpCode.CHARACTER_LIST:\r\n                this.handleCharacterList(data, status);\r\n                break;\r\n            case OpCode.CHARACTER_CREATE:\r\n                this.handleCharacterCreate(data, status);\r\n                break;\r\n            case OpCode.ENTER_MAP:\r\n                this.handleMapEnter(data, status);\r\n                break;\r\n            case OpCode.ENTER_INSTANCE:\r\n                this.handleInstanceEnter(data, status);\r\n                break;\r\n            case OpCode.CHAT_MESSAGE:\r\n                this.handleChatMessage(data, status);\r\n                break;\r\n            case OpCode.OBJECT_CREATE:\r\n                this.handleObjectCreate(data, status);\r\n                break;\r\n            case OpCode.OBJECT_DELETE:\r\n                this.handleObjectDelete(data, status);\r\n                break;\r\n            case OpCode.OBJECT_UPDATE:\r\n                this.handleObjectUpdate(data, status);\r\n                break;\r\n            case OpCode.OBJECT_STATS:\r\n                this.handleObjectStats(data, status);\r\n                break;\r\n            case OpCode.ABILITY_LIST:\r\n                this.handleAbilityList(data, status);\r\n                break;\r\n            case OpCode.CREATE_INSTANCE:\r\n                this.handleCreateInstance(data, status);\r\n                break;\r\n            case OpCode.MAP_PLAYERS:\r\n                this.handleMapPlayers(data, status);\r\n                break;\r\n        }\r\n    }\r\n\r\n    // handles a login response \r\n    handleLogin(data, status){\r\n        // extract response properties\r\n        let {message=null, clientID=null, accessLevel=1} = data;\r\n\r\n        // store clientID and access level if there was a successful login \r\n        if(status === Status.GOOD){\r\n            this.clientID =     clientID;\r\n            this.accessLevel =  accessLevel;\r\n        }\r\n\r\n        // trigger login listeners\r\n        this.emit(\"login\", {message, status})\r\n    }\r\n\r\n    // handles a logout acknowledgement \r\n    handleLogout(data, status){\r\n        // extract response properties\r\n        let {message=null} = data;\r\n\r\n        // trigger logout listeners\r\n        this.emit(\"logout\", {message, status});\r\n    }\r\n\r\n    // handles a character list response \r\n    handleCharacterList(data, status){\r\n        // extract response properties\r\n        let {message=null, characterList=null} = data;\r\n\r\n        // trigger character list listeners\r\n        this.emit(\"character-list\", {message, characterList, status});\r\n    }\r\n\r\n    // handles character create response \r\n    handleCharacterCreate(data, status){\r\n        // extract response properties\r\n        let {message=null} = data;\r\n\r\n        // trigger character create listeners\r\n        this.emit(\"character-create\", {message, status});\r\n    }\r\n\r\n    // handles entering a map response\r\n    handleMapEnter(data, status){\r\n        // extract response properties \r\n        let {message=null, mapState=null} = data;\r\n\r\n        // trigger entering map listeners \r\n        this.emit(\"enter-map\", {message, mapState, status});\r\n    }\r\n\r\n    // handles enter an instance repsonse \r\n    handleInstanceEnter(data, status){\r\n        // extract response properties \r\n        let {message=null, mapState=null} = data;\r\n\r\n        // trigger entering instance listeners\r\n        this.emit(\"enter-instance\", {message, mapState, status});\r\n    }\r\n\r\n    // handles a chat message\r\n    handleChatMessage(data, status){\r\n        // extract response properties \r\n        let {chat=\"\", from=null} = data;\r\n        \r\n        // trigger chat listeners\r\n        this.emit(\"chat\", {chat, from, status});\r\n    }\r\n\r\n    // handles object creation notification\r\n    handleObjectCreate(data){\r\n        // extract object properties\r\n        let {spawnState=null} = data;\r\n\r\n        // trigger object create listeners\r\n        this.emit(\"object-create\", {spawnState});\r\n    }\r\n\r\n    // handles object delete notifications \r\n    handleObjectDelete(data){\r\n        // extract response properties \r\n        let {objectID=null} = data;\r\n\r\n        // trigger object delete listeners\r\n        this.emit(\"object-delete\", {objectID});\r\n    }\r\n\r\n    // handles object update notifications \r\n    handleObjectUpdate(data){\r\n        // extract response properties \r\n        let {updateState=null} = data;\r\n\r\n        // trigger object update listeners\r\n        this.emit(\"object-update\", {updateState});\r\n    }\r\n\r\n    // handles object stats response\r\n    handleObjectStats(data, status){\r\n        // extract response properties \r\n        let {message=null, stats=null} = data;\r\n\r\n        // trigger object stats listeners \r\n        this.emit(\"object-stats\", {message, stats, status});\r\n    }\r\n\r\n    // handles ability list response\r\n    handleAbilityList(data, status){\r\n        // extract response properties\r\n        let {message=null, abilityList=null} = data;\r\n\r\n        // trigger ability list listeners\r\n        this.emit(\"ability-list\", {message, abilityList, status});\r\n    }\r\n\r\n    // handles create instance reponse \r\n    handleCreateInstance(data, status){\r\n        // extract response properties\r\n        let {message=null} = data;\r\n\r\n        // trigger create instance listeners\r\n        this.emit(\"create-instance\", {message, status});\r\n    }\r\n\r\n    // handles map players response \r\n    handleMapPlayers(data, status){\r\n        // extract response properties\r\n        let {message=null, players=null} = data;\r\n\r\n        // trigger map players listeners\r\n        this.emit(\"map-players\", {players, status});\r\n    }\r\n\r\n    // request to login to an account\r\n    // gives the login credentials: username, password, and client verison \r\n    login(username, password){\r\n        let version = CLIENT_VERSION;\r\n        this.send(OpCode.ACCOUNT_LOGIN, {username, password, version});\r\n    }\r\n\r\n    // submit a logout to the server\r\n    logout(){\r\n        // destroy current ID\r\n        this.clientID = null;\r\n        // send request\r\n        this.send(OpCode.ACCOUNT_LOGOUT);\r\n    }\r\n\r\n    // request the list of all characters associated with the account\r\n    // (*** gives a 'preview' which does not include all character data ***)\r\n    getCharacterList(){\r\n        this.send(OpCode.CHARACTER_LIST);\r\n    }\r\n\r\n    // requests a character to be created\r\n    // gives the name and skin ID of the character\r\n    createCharacter(name, skin){\r\n        this.send(OpCode.CHARACTER_CREATE, {name, skin});\r\n    }\r\n\r\n    // request a character select (*** auto joins map ***)\r\n    // gives the name of the selected character\r\n    selectCharacter(name){\r\n        this.send(OpCode.CHARACTER_SELECT, {name});\r\n    }\r\n\r\n    // submits a chat message\r\n    // gives the chat text \r\n    chatMessage(chat){\r\n        this.send(OpCode.CHAT_MESSAGE, {chat});\r\n    }\r\n\r\n    // submits a player update\r\n    // gives the player's current data (x, y, anim, objectID)\r\n    playerUpdate(data){\r\n        this.send(OpCode.OBJECT_UPDATE, data);\r\n    }\r\n\r\n    // requests the stats for a target object\r\n    // gives the objectID of the target\r\n    getObjectStats(objectID){\r\n        this.send(OpCode.OBJECT_STATS, {objectID});\r\n    }\r\n\r\n    // requests the current ability list\r\n    getAbilityList(){\r\n        this.send(OpCode.ABILITY_LIST);\r\n    }\r\n\r\n    // requests an ability ugrade\r\n    // gives the name of the ability to upgrade \r\n    upgradeAbility(abilityName){\r\n        this.send(OpCode.ABILITY_UPGRADE, {abilityName});\r\n    }\r\n\r\n    // request an ability cast\r\n    // gives the ability's name and the target's objectID \r\n    castAbility(abilityName, objectID){\r\n        this.send(OpCode.ABILITY_CAST, {abilityName, objectID});\r\n    }\r\n\r\n    // requests an instance to be generated\r\n    // gives teh name of the instance to create\r\n    createInstance(instanceName){\r\n        this.send(OpCode.CREATE_INSTANCE, {instanceName});\r\n    }\r\n\r\n    // requests info about every player in the current map\r\n    getMapPlayers(){\r\n        this.send(OpCode.MAP_PLAYERS);\r\n    }\r\n\r\n    // sends a formatted request through the websocket \r\n    send(opCode, data){\r\n        // server expects json string with opCode and data \r\n        this.sendString(JSON.stringify({opCode, data}));\r\n    }\r\n\r\n    // sends a utf8 string to the client (auto delimited for if messages are sent together)\r\n    sendString(str){\r\n        // must be connected to send requests \r\n        if(this.isConnected){\r\n            this.socket.send(str + MSG_DELIM);\r\n        }\r\n    }\r\n\r\n    // connected client = has a socket that is in the connected ready state \r\n    get isConnected(){\r\n        return this.socket && this.socket.readyState === 1;\r\n    }\r\n}\r\n\r\n// export singleton\r\nexport default new Client();","import React from \"react\";\r\nimport { CLIENT_VERSION } from \"./../game/Client\";\r\n\r\nexport class Footer extends React.Component{\r\n    render(){\r\n        return (\r\n            <footer className=\"text-center\">\r\n                <hr/>\r\n                David Rosenblum, 2019 | v{CLIENT_VERSION}\r\n            </footer>\r\n        );\r\n    }\r\n}","import { EventEmitter } from \"events\";\r\n\r\nclass ModalDispatcher extends EventEmitter{\r\n    modal(header, body, footer){\r\n        this.emit(\"modal\", {header, body, footer});\r\n    }\r\n}\r\n\r\n// export singleton\r\nexport default new ModalDispatcher();","import { EventEmitter } from \"events\";\r\n\r\nclass NavDispatcher extends EventEmitter{\r\n    showMenu(menu){\r\n        this.emit(\"menu\", {menu});\r\n    }\r\n\r\n    showLogin(){\r\n        this.showMenu(\"login\");\r\n    }\r\n\r\n    showRegister(){\r\n        this.showMenu(\"register\");\r\n    }\r\n\r\n    showCharacterSelect(){\r\n        this.showMenu(\"character-select\")\r\n    }\r\n\r\n    showCharacterCreate(){\r\n        this.showMenu(\"character-create\");\r\n    }\r\n\r\n    showGame(){\r\n        this.showMenu(\"game\");\r\n    }\r\n}\r\n\r\n// export singleton\r\nexport default new NavDispatcher();","import React from \"react\";\r\nimport { Form, FormGroup, Label, Input, Button, Row, Col } from \"reactstrap\";\r\nimport { BUTTON_WIDTH, INPUT_MAX_LENGTH } from \"../data/Data\";\r\nimport { Banner } from \"./Banner\";\r\nimport { Footer } from \"./Footer\";\r\nimport Client from \"../game/Client\";\r\nimport ModalDispatcher from \"../dispatchers/ModalDispatcher\";\r\nimport NavDispatcher from \"../dispatchers/NavDispatcher\";\r\n\r\n\r\nexport class Login extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n\r\n        this.usernameInput = null;      // username <input>\r\n        this.passwordInput = null;      // password <input>\r\n        this.usernameToSave = null;     // username to save to local storage (to load next time)\r\n\r\n        this.state = {\r\n            pending: false              // awaiting login response (locks the UI)\r\n        };\r\n\r\n        // handler for when the client's websocket establishes a connection to the server\r\n        // (note: close and error are handled in App.jsx)\r\n        this.onConnect = () => {\r\n            // connected - unlock the UI \r\n            this.setState({pending: false});   \r\n        };\r\n\r\n        // handler for when the client receives the login response\r\n        this.onLogin = evt => {\r\n            // got a resposne \r\n            if(evt.status === \"ok\"){\r\n                // successful login\r\n                // stores the username \r\n                this.saveUsername(this.usernameToSave);\r\n                // show the character selection menu\r\n                NavDispatcher.showCharacterSelect();\r\n            }\r\n            else{\r\n                // failed to login - display error message\r\n                ModalDispatcher.modal(\"Login Error\", evt.message);\r\n                // unlock the UI\r\n                this.setState({pending: false});\r\n            }\r\n        };\r\n    }\r\n\r\n    componentDidMount(){\r\n        // listen for the client's websocket to connect\r\n        Client.on(\"connect\", this.onConnect);\r\n        // listen for the client to receive a login response \r\n        Client.on(\"login\", this.onLogin);\r\n\r\n        // restore last successful login username from local storage\r\n        this.usernameInput.value = this.getSavedUsername() || \"\";\r\n\r\n        // if the socket is not connected\r\n        if(!Client.isConnected){\r\n            // lock the UI and connect (connection unlocks UI)\r\n            this.setState({pending: true});\r\n            Client.connect();\r\n        }\r\n    }\r\n\r\n    componentWillUnmount(){\r\n        // stop listening for the client's websocket to connect (prevents leak)\r\n        Client.removeListener(\"connect\", this.onConnect);\r\n        // stop listening for the client to receive a login response (prevents leak)\r\n        Client.removeListener(\"login\", this.onLogin);\r\n    }\r\n\r\n    // when the create account button is clicked...\r\n    onCreate(){\r\n        // show the register account menu \r\n        NavDispatcher.showRegister();\r\n    }\r\n\r\n    // when the login form is submitted...\r\n    onSubmit(evt){\r\n        // prevent page reload\r\n        evt.preventDefault();\r\n\r\n        // extract username text\r\n        let username = this.usernameInput.value;\r\n        // extract password text\r\n        let password = this.passwordInput.value;\r\n\r\n        // store the username (will save to local storage on successful login)\r\n        this.usernameToSave = username;\r\n\r\n        // send the login request \r\n        Client.login(username, password);\r\n    }\r\n\r\n    // saves the parameter to local storage as 'username'\r\n    saveUsername(username){\r\n        window.localStorage.setItem(\"username\", username);\r\n    }\r\n\r\n    // gets the last saved 'username' value \r\n    getSavedUsername(){\r\n        return window.localStorage.getItem(\"username\") || null;\r\n    }\r\n\r\n    render(){\r\n        return (\r\n            <div>\r\n                <br/>\r\n                <Banner/>\r\n                <br/>\r\n                <div className=\"app-menu\">\r\n                    <Form onSubmit={this.onSubmit.bind(this)}>\r\n                        <FormGroup>\r\n                            <Label>Username</Label>\r\n                            <Input\r\n                                innerRef={input => this.usernameInput = input}\r\n                                type=\"text\"\r\n                                maxLength={INPUT_MAX_LENGTH}\r\n                                disabled={this.state.pending}\r\n                                required\r\n                            />\r\n                        </FormGroup>\r\n                        <FormGroup>\r\n                            <Label>Password</Label>\r\n                            <Input\r\n                                innerRef={input => this.passwordInput = input}\r\n                                type=\"password\"\r\n                                maxLength={INPUT_MAX_LENGTH}\r\n                                disabled={this.state.pending}\r\n                                required\r\n                            />\r\n                        </FormGroup>\r\n                        <div className=\"text-center\">\r\n                            <Button width={BUTTON_WIDTH} disabled={this.state.pending}>\r\n                                Submit\r\n                            </Button>\r\n                            &nbsp;\r\n                            <Button\r\n                                type=\"button\"\r\n                                width={BUTTON_WIDTH}\r\n                                disabled={this.state.pending}\r\n                                onClick={this.onCreate.bind(this)}\r\n                            >\r\n                                Create\r\n                            </Button>\r\n                        </div>\r\n                    </Form>\r\n                    <Footer/>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}","/*\r\n    UI constants \r\n*/\r\n\r\n// <input> max length, such as username\r\nexport const INPUT_MAX_LENGTH =     20;     \r\n\r\n// <button> width, so all buttons are the same size regardless of text length\r\nexport const BUTTON_WIDTH =         125;   \r\n\r\n// max length for the character create name <input> \r\nexport const NAME_MAX_LENGTH =      15;\r\n\r\n// size of the ability icon <img> during gameplay \r\nexport const ABILITY_ICON_SIZE =    64;","export class Ajax{\r\n    // sends an http request (returns a promise)\r\n    static request(options){\r\n        return new Promise((resolve, reject) => {\r\n            // extract request parameters \r\n            let {url, method=\"GET\", headers=null, query=null, data=null} = options;\r\n\r\n            // create the request\r\n            let xhr = new XMLHttpRequest();\r\n            // handle\r\n            xhr.addEventListener(\"load\", () => resolve(xhr));\r\n            // handle errors\r\n            xhr.addEventListener(\"error\", err => reject(err));\r\n\r\n            // optional query strings\r\n            if(query){\r\n                url += Ajax.queryString(query);\r\n            }\r\n\r\n            // open the request\r\n            xhr.open(method, url, true);\r\n            \r\n            // optional request headers\r\n            if(headers){\r\n                for(let header in headers){\r\n                    xhr.setRequestHeader(header, headers[header]);\r\n                }\r\n            }\r\n\r\n            // send the request \r\n            xhr.send(data);\r\n        });\r\n    }\r\n\r\n    // sends an http GET request \r\n    static get(url, headers, query, data){\r\n        return Ajax.request({url, headers, query, data, method: \"GET\"});\r\n    }\r\n\r\n    // sends an http POST request\r\n    static post(url, headers, query, data){\r\n        return Ajax.request({url, headers, query, data, method: \"POST\"});\r\n    }\r\n\r\n    // generates a query string for the given parameters\r\n    // {linkinPark: \"meteora\", tool: \"lateralus\"} -> \"?linkinPark=meteora&tool=lateralus\"\r\n    static queryString(parameters){\r\n        let params = [];\r\n\r\n        for(let param in parameters){\r\n            params.push(`${param}=${parameters[param]}`);\r\n        }\r\n\r\n        return \"?\" + params.join(\"&\");\r\n    }\r\n\r\n    // gets simple cross-origin resource sharing (cors) headers object\r\n    static getCorsHeaders(origin=\"*\"){\r\n        return {\r\n            \"Access-Control-Allow-Origin\": origin,\r\n            \"Access-Control-Allow-Headers\": \"Access-Control-Allow-Origin\"\r\n        };\r\n    }\r\n}","import React from \"react\";\r\nimport { Form, FormGroup, Label, Input, Button } from \"reactstrap\";\r\nimport { BUTTON_WIDTH, INPUT_MAX_LENGTH } from \"../data/Data\";\r\nimport { Footer } from \"./Footer\";\r\nimport { Banner } from \"./Banner\";\r\nimport { Ajax } from \"../utils/Ajax\";\r\nimport ModalDispatcher from \"../dispatchers/ModalDispatcher\";\r\nimport NavDispatcher from \"../dispatchers/NavDispatcher\";\r\n\r\nexport class Register extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n\r\n        this.usernameInput = null;      // username <input>\r\n        this.passwordInput = null;      // password <input>\r\n        this.confirmInput = null;       // confirm password <input>\r\n\r\n        this.state = {\r\n            pending: false              // awaiting account create response (locks UI)\r\n        };\r\n    }\r\n\r\n    // clears the form text fields \r\n    clearForm(){\r\n        this.usernameInput.value = \"\";  // clear the username <input> text\r\n        this.passwordInput.value = \"\";  // clear the password <input> text\r\n        this.confirmInput.value = \"\";   // clear the confirm password <input> text\r\n    }\r\n\r\n    // when the cancel buton is clicked...\r\n    onCancel(){\r\n        // show the login menu\r\n        NavDispatcher.showLogin();\r\n    }\r\n\r\n    // when the form is submitted...\r\n    onSubmit(evt){\r\n        // prevent page reload \r\n        evt.preventDefault();\r\n\r\n        // lock the UI \r\n        this.setState({pending: true});\r\n\r\n        // extract username text\r\n        let username = this.usernameInput.value;\r\n        // extract password text\r\n        let password = this.passwordInput.value;\r\n        // extract confirm password text \r\n        let confirm = this.confirmInput.value;\r\n\r\n        // enforce the passwords match \r\n        if(password !== confirm){\r\n            // they do not - display error\r\n            ModalDispatcher.modal(\"Passwords Error\", \"Passwords do not match.\");\r\n            // unlock UI\r\n            this.setState({pending: false});\r\n            return;\r\n        }\r\n\r\n        // generate the url for character creation API \r\n        let url = `${window.location.origin.replace(\":3000\", \":8080\")}/accounts/create`;\r\n        // get request header (cors)\r\n        let headers = Ajax.getCorsHeaders();\r\n        // no request query\r\n        let query = null;\r\n        // create a json string of the account data\r\n        let data = JSON.stringify({username, password});\r\n\r\n        // send the request \r\n        Ajax.post(url, headers, query, data)\r\n            .then(xhr => {\r\n                // server responded - could be good or bad\r\n                // set header based on success (200 == success)\r\n                let header = xhr.status === 200 ? \"Account Created\" : \"Account Error\";\r\n                // display the response (xhr.response is server-generated)\r\n                ModalDispatcher.modal(header, xhr.response);\r\n\r\n                // clear input fields on success\r\n                if(xhr.status === 200){\r\n                    this.clearForm();\r\n                }\r\n            })\r\n            .catch(() => {\r\n                // http request error, basically request failed to send (not a 4xx or 5xx!)\r\n                ModalDispatcher.modal(\"Request Error\", \"HTTP request failed.\");\r\n            })\r\n            .then(() => {\r\n                // unlock the UI \r\n                this.setState({pending: false})\r\n            });\r\n    }\r\n\r\n    render(){\r\n        return (\r\n            <div>\r\n                <br/>\r\n                <Banner/>\r\n                <br/>\r\n                <div className=\"app-menu\">\r\n                    <Form onSubmit={this.onSubmit.bind(this)}>\r\n                        <FormGroup>\r\n                            <Label>Username</Label>\r\n                            <Input\r\n                                innerRef={input => this.usernameInput = input}\r\n                                type=\"text\"\r\n                                maxLength={INPUT_MAX_LENGTH}\r\n                                disabled={this.state.pending}\r\n                                required\r\n                            />\r\n                        </FormGroup>\r\n                        <FormGroup>\r\n                            <Label>Password</Label>\r\n                            <Input\r\n                                innerRef={input => this.passwordInput = input}\r\n                                type=\"password\"\r\n                                maxLength={INPUT_MAX_LENGTH}\r\n                                disabled={this.state.pending}\r\n                                required\r\n                            />\r\n                        </FormGroup>\r\n                        <FormGroup>\r\n                            <Label>Confirm Password</Label>\r\n                            <Input\r\n                                innerRef={input => this.confirmInput = input}\r\n                                type=\"password\"\r\n                                maxLength={INPUT_MAX_LENGTH}\r\n                                disabled={this.state.pending}\r\n                                required\r\n                            />\r\n                        </FormGroup>\r\n                        <div className=\"text-center\">\r\n                            <Button width={BUTTON_WIDTH} disabled={this.state.pending}>\r\n                                Submit\r\n                            </Button>\r\n                            &nbsp;\r\n                            <Button\r\n                                width={BUTTON_WIDTH}\r\n                                type=\"button\"\r\n                                onClick={this.onCancel.bind(this)}\r\n                                disabled={this.state.pending}\r\n                            >\r\n                                Cancel\r\n                            </Button>\r\n                        </div>\r\n                    </Form>\r\n                    <Footer/>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}","import * as fw from \"@davidrosenblum/frostwork\";\r\nimport blacksmith from \"../img/red.png\";\r\nimport paragon from \"../img/red.png\";\r\nimport templar from \"../img/red.png\";\r\nimport player from \"../img/blue.png\";\r\n\r\nexport class GameObject extends fw.MPGameEntity{\r\n    constructor(imgAlias, width, height, name, objectID, team, anim){\r\n        super(fw.AssetUtils.getImageURLByAlias(imgAlias), width, height, 0, 0, objectID, team);\r\n\r\n        if(name) this.setNametag(name);\r\n        if(anim) this.playAnimation(anim);\r\n    }\r\n}\r\n\r\nexport const GameObjectFactory = {\r\n    create(data){\r\n        let {type, name, anim, objectID, team} = data;\r\n\r\n        switch(type){\r\n            case \"blacksmith\":\r\n                return new GameObject(\"blacksmith\", 100, 100, name, objectID, team, anim);\r\n            case \"paragon\":\r\n                return new GameObject(\"paragon\", 100, 100, name, objectID, team, anim);\r\n            case \"templar\":\r\n                return new GameObject(\"templar\", 100, 100, name, objectID, team, anim);\r\n            case \"player\":\r\n                return new GameObject(\"player\", 100, 100, name, objectID, team, anim);\r\n            default:\r\n                return null;\r\n        }\r\n    }\r\n};\r\n\r\nfw.AssetUtils.setImageAliasMany({\r\n    blacksmith, paragon, templar, player\r\n})","import * as fw from \"@davidrosenblum/frostwork\";\r\nimport { TILE_SIZE } from \"../game/Game\";\r\nimport grass from \"../img/grass.png\";\r\n\r\n// holds all the map tile classes \r\nexport const MapTiles = {\r\n    Grass: class Grass extends fw.Sprite{\r\n        constructor(){\r\n            super(fw.AssetUtils.getImageURLByAlias(\"grass\"), TILE_SIZE, TILE_SIZE);\r\n        }\r\n    }\r\n};\r\n\r\n// all map object image files (maps usable name: react image file)\r\nfw.AssetUtils.setImageAliasMany({\r\n    grass\r\n});","import * as fw from \"@davidrosenblum/frostwork\";\r\nimport airship from \"../img/silver.png\";\r\n\r\n// transport objects are game entities that can't move and have nodeIDs \r\nexport class TransportObject extends fw.GameEntity{\r\n    constructor(imgAlias, width, height, nodeID, text){\r\n        super(fw.AssetUtils.getImageURLByAlias(imgAlias), width, height);\r\n\r\n        this.nodeID = nodeID;\r\n        this.setNametag(text);\r\n        this.moveSpeed = 0;\r\n    }\r\n}\r\n\r\n// creates transport objects using server-provided data\r\nexport const TransportObjectFactory = {\r\n    create(data){\r\n        let {type, nodeID, text} = data;\r\n\r\n        switch(type){\r\n            case \"airship\":\r\n                return new TransportObject(\"airship\", 100, 100, nodeID, text, nodeID, text);\r\n            default:\r\n                return null;\r\n        }\r\n    }\r\n}\r\n\r\n// all transport object image files (maps usable name: react image file)\r\nfw.AssetUtils.setImageAliasMany({\r\n    airship\r\n});","import * as fw from \"@davidrosenblum/frostwork\";\r\nimport { EventEmitter } from \"events\";\r\nimport { GameObjectFactory } from \"../data/GameObjects\";\r\nimport { MapTiles } from \"../data/MapObjects\";\r\nimport { TransportObjectFactory } from \"../data/TransportObjects\";\r\nimport Client from \"./Client\";\r\nimport ModalDispatcher from \"../dispatchers/ModalDispatcher\";\r\n\r\n// how big each tile square is for the game (game is tile-based)\r\nexport const TILE_SIZE = 64;\r\n\r\n// default font for each unit's nametag and any floating game text \r\nfw.TextField.defaultFont = \"15px electrolize\";\r\n\r\n// game singleton\r\nclass Game extends EventEmitter{\r\n    constructor(){\r\n        super();\r\n\r\n        this.renderer = new fw.Renderer(1280, 720);     // the renderer (has the canvas)\r\n        this.layers = new fw.MapLayers();               // map layers (background, midground, foreground)\r\n        this.objects = new fw.MPEntityStorage();        // game object updater\r\n        this.keys = null;                               // keyboard input listener\r\n        this.collisionGrid = null;                      // has every static collidable object stored\r\n        this.mapBounds = null;                          // the bounds of the map\r\n        this.scroller = null;                           // performs x-y scrolling\r\n        this.player = null;                             // the player object\r\n\r\n        // current selected game object\r\n        this.selectedTarget = null;\r\n\r\n        // process everything required for next frame before the underlying framework is renders\r\n        this.renderer.on(\"render\", this.onGameFrame.bind(this));\r\n        // when the renderer's canvas is clicked, have the layers object determine if a game object is at the mouse \r\n        this.renderer.on(\"click\", evt => this.layers.processClick(evt));\r\n\r\n        // game is not started and ready to receive tasks\r\n        this.started = false;\r\n        this.todo = [];\r\n    }\r\n\r\n    // preloads assets (marked in the /data folder)\r\n    loadAssets(){\r\n        // since file paths can be long and weird\r\n        // each asset is mapped to a friendly name (like player instead of foo/bar/player.png)\r\n        // and all marked assets can be asychronously loaded at once \r\n        return fw.AssetUtils.loadAliases();\r\n    }\r\n\r\n    // asychronously loads the map \r\n    // mapState is provided by the server \r\n    async loadMap(mapState){\r\n        // destroy existing map\r\n        this.unloadMap();\r\n\r\n        // extract response data \r\n        let {name, mapData, transportNodes, units} = mapState;\r\n        \r\n        // asychronously load all assets (wait for this to complete)\r\n        let report = await this.loadAssets();\r\n        \r\n        // calculate the total amount of assets failed to load (hopefully 0!) \r\n        let errs = report.images.errors + report.sounds.errors; \r\n        if(errs){\r\n            // 1+ errors found - alert the user that assets failed to load\r\n            // (game continues)\r\n            ModalDispatcher.modal(\r\n                \"Assets Error\",\r\n                `Error: ${errs} assets failed to load. The game will run, but some things might be missing.`\r\n            );\r\n        }\r\n\r\n        // build the map, which returns the GMD (generated map data - includes bounds & collision data)\r\n        let gmd = this.layers.buildMap({\r\n            tileSize: TILE_SIZE,\r\n            background: {\r\n                tileLayout: mapData.background,\r\n                tileTypes:  [null, MapTiles.Grass]\r\n            },\r\n            midground: {\r\n                tileLayout: mapData.midground,\r\n                tileTypes:  [null]\r\n            },\r\n            foreground: {\r\n                tileLayout: mapData.foreground,\r\n                tileTypes:  [null]\r\n            },\r\n        });\r\n\r\n        // instantiate the keyboard listener (used for keyboard inputs)\r\n        this.keys = new fw.KeyboardWatcher();\r\n        // click '+' to toggle map grid \r\n        this.keys.onKey(\"+\", () => this.layers.toggleMapGrid());\r\n        // collision grid for collision detection, relative to loaded map\r\n        this.collisionGrid = gmd.collisionGrid;\r\n        // get the bounds (top, left, bottom, right) of the map \r\n        this.mapBounds = gmd.mapBounds;\r\n        // scroller to have X-Y scrolling \r\n        this.scroller = new fw.Scroller(this.renderer, this.mapBounds);\r\n\r\n        // create each transport node \r\n        transportNodes.forEach(tData => this.createTransportNode(tData));\r\n        // create each game object (synonymous in the code as 'unit')\r\n        units.forEach(uData => this.createObject(uData));\r\n\r\n        // begin rendering the game\r\n        this.renderer.startRendering(this.layers.mapSprite);\r\n\r\n        // game at this point is considered initialized\r\n        this.started = true;\r\n        // process every task that occurred between the server entering this client in the map and now \r\n        this.todo.forEach(task => task());\r\n        // reset the task list for next time \r\n        this.todo = [];\r\n    }\r\n\r\n    // destroys the current map\r\n    // game stops listening for inputs and stops rendering \r\n    unloadMap(){\r\n        // the game is no longer initialized\r\n        this.started = false;\r\n        // stop renderings\r\n        this.renderer.stopRendering();\r\n\r\n        // remove all objects from all draw lists\r\n        this.layers.removeAll();\r\n        // reset object updater \r\n        this.objects.clear();\r\n\r\n        // nullify fields relevant to current map \r\n        this.keys = null;\r\n        this.collisionGrid = null;\r\n        this.mapBounds = null;\r\n        this.scroller = null;\r\n        this.player = null;\r\n    }\r\n\r\n    // creates a game object\r\n    createObject(data){\r\n        // if the game has not started, process this when the game begins\r\n        // (handles case were create object update comes while the game is still initializing)\r\n        if(!this.started){\r\n            this.todo.push(() => this.createObject(data));\r\n            return;\r\n        }\r\n\r\n        // extract possible location of object\r\n        let {x, y, spawnLocation} = data;\r\n        // create the object \r\n        let object = GameObjectFactory.create(data);\r\n\r\n        // if the object was created and successfully added...\r\n        if(object && this.objects.addObject(object)){\r\n            // position the object\r\n            // use spawn location (col-row), fallback to pixel position (x-y)\r\n            if(spawnLocation){\r\n                // extract column & row\r\n                let {col, row} = spawnLocation;\r\n                // place the object\r\n                this.layers.addAt(object, col, row);\r\n            }\r\n            else{\r\n                // no col-row provided, position at current x-y point \r\n                this.layers.add(object);\r\n                object.setPosition(x, y);\r\n            }\r\n\r\n            // select any object when it is clicked \r\n            object.on(\"click\", () => this.selectTarget(object));\r\n\r\n            // check if the object is the current player \r\n            if(data.type === \"player\" && data.ownerID === Client.clientID){\r\n                // player found!\r\n                this.player = object;\r\n                // update the server on validated movements \r\n                object.on(\"move\", () => Client.playerUpdate(object.getData()));\r\n                // load the current stats and abilities \r\n                Client.getObjectStats(object.objectID);\r\n                Client.getAbilityList();\r\n            }\r\n        }\r\n    }\r\n\r\n    // removes an object from the game (won't be rendered or updated)\r\n    removeObject(objectID){\r\n        // if the game has not started, process this when the game begins\r\n        // (handles case were delete object update comes while game is still initializing)\r\n        if(!this.started){\r\n            this.todo.push(() => this.removeObject(objectID));\r\n            return;\r\n        }\r\n\r\n        // find the object\r\n        let object = this.objects.getObject(objectID);\r\n        // if the object exists (it always should), remove it from rendering and updater\r\n        if(object){\r\n            object.remove();\r\n            this.objects.removeObject(object);\r\n\r\n            // selected target just deleted?\r\n            if(Game.selectedTarget && Game.selectedTarget.objectID === objectID){\r\n                Game.unselectTarget();\r\n            }\r\n        }\r\n    }\r\n\r\n    // updates a game object (animation, position, etc)\r\n    updateObject(data){\r\n        // if the game has not started, process this when the game begins\r\n        // (handles case were update object comes while game is still initializing)\r\n        if(!this.started){\r\n            this.todo.push(() => this.updateObject(data));\r\n            return;\r\n        }\r\n\r\n        // tell the updater to update apply the object update\r\n        this.objects.updateObject(data);\r\n    }\r\n\r\n    // creates a transport node object \r\n    // used for requesting to enter a new map \r\n    createTransportNode(data){\r\n        // get the spawn location (tile points, not x-y)\r\n        let {col, row} = data.spawnLocation;\r\n        // create the object\r\n        let tnode = TransportObjectFactory.create(data);\r\n        // if successful, add it to the game \r\n        if(tnode){\r\n            this.layers.addAt(tnode, col, row);\r\n        }\r\n    }\r\n\r\n    // injects the <canvas> into the DOM \r\n    // (not very reactful)\r\n    injectInto(element){\r\n        this.renderer.injectInto(element);\r\n    }\r\n\r\n    // selects an object - requests the target's stats (triggers UI update)\r\n    selectTarget(target){\r\n        // remove current selection\r\n        this.unselectTarget();\r\n        // store new target\r\n        this.selectedTarget = target;\r\n        // get target stats (triggers UI update)\r\n        Client.getObjectStats(target.objectID);\r\n    }\r\n\r\n    // cancels current target selection \r\n    unselectTarget(){\r\n        // must have a target \r\n        if(this.selectedTarget){\r\n            // (remove any changes made)\r\n            // remove now previous target\r\n            this.selectedTarget = null;\r\n        }\r\n    }\r\n\r\n    // submits a cast ability request to the server \r\n    castAbility(abilityName){\r\n        // must have a target\r\n        if(this.selectedTarget){\r\n            // send the request \r\n            Client.castAbility(abilityName, this.selectedTarget.objectID);\r\n        }\r\n    }\r\n\r\n    // immediately before rendering the next frame... \r\n    onGameFrame(){\r\n        // check for movement input if a player exists and if at least 1 key is pressed \r\n        if(this.player && this.keys.numKeys > 0){\r\n            // move up? \r\n            if(this.keys.isKeyDown(\"w\")){\r\n                this.player.moveUp(this.collisionGrid, this.mapBounds, this.scroller);\r\n            }\r\n            // move down?\r\n            else if(this.keys.isKeyDown(\"s\")){\r\n                this.player.moveDown(this.collisionGrid, this.mapBounds, this.scroller);\r\n            }\r\n            // move left? \r\n            if(this.keys.isKeyDown(\"a\")){\r\n                this.player.moveLeft(this.collisionGrid, this.mapBounds, this.scroller);\r\n            }\r\n            // move right?\r\n            else if(this.keys.isKeyDown(\"d\")){\r\n                this.player.moveRight(this.collisionGrid, this.mapBounds, this.scroller);\r\n            }\r\n\r\n            // depth sort the game (midground) layer \r\n            this.layers.depthSort();\r\n        }\r\n    }\r\n}\r\n\r\n// export singleton \r\nexport default new Game();","import React from \"react\";\r\nimport { Table, Button } from \"reactstrap\";\r\nimport { BUTTON_WIDTH } from \"../data/Data\";\r\nimport Client from \"../game/Client\";\r\nimport Game from \"../game/Game\";\r\nimport ModalDispatcher from \"../dispatchers/ModalDispatcher\";\r\nimport NavDispatcher from \"../dispatchers/NavDispatcher\";\r\n\r\nexport class CharacterSelect extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n\r\n        this.state = {\r\n            pending:        false,  // awaiting character list (locks UI)\r\n            characterList:  null,   // character list array\r\n            errMessage:     null    // error message string \r\n        };\r\n\r\n        // handler for when the client receives the character list \r\n        this.onCharacterList = evt => {\r\n            if(evt.status === \"ok\"){\r\n                // succeess - render character list\r\n                this.setState({characterList: evt.characterList || null});\r\n            }\r\n            else{\r\n                // failed - display error message\r\n                ModalDispatcher.modal(\"Characters Error\", evt.message);\r\n                this.setState({errMessage: evt.message});\r\n            }\r\n        };\r\n\r\n        // handler for when the client receives the enter map OR enter instance signal \r\n        this.onEnterMap = evt => {\r\n            // must be successful to continue to game\r\n            if(evt.status === \"ok\"){\r\n                // success - show the game\r\n                NavDispatcher.showGame();\r\n                // begin loading the map with received map data\r\n                Game.loadMap(evt.mapState);\r\n            }\r\n            else{\r\n                // fail - display error message\r\n                ModalDispatcher.modal(\"Characters Error\", evt.message);\r\n                // unlock UI \r\n                this.setState({pending: false});\r\n            }\r\n        };\r\n    }\r\n\r\n    componentDidMount(){\r\n        // listen for the client to receive the character list\r\n        Client.on(\"character-list\", this.onCharacterList);\r\n        // listen for the client to enter a map (this will happen after successful character select)\r\n        Client.on(\"enter-map\", this.onEnterMap);\r\n        // listen for the client to enter an instance \r\n        Client.on(\"enter-instance\", this.onEnterMap);\r\n\r\n        // request the character list \r\n        Client.getCharacterList();\r\n    }\r\n\r\n    componentWillUnmount(){\r\n        // stop listening for the client to receive the character list (prevents leak)\r\n        Client.removeListener(\"character-list\", this.onCharacterList);\r\n        // stop listening for the client to receive the enter map signal (prevents leak)\r\n        Client.removeListener(\"enter-map\", this.onEnterMap);\r\n        // stop listening for the client to receive the enter instance signal (prevents leak)\r\n        Client.removeListener(\"enter-instance\", this.onEnterMap);\r\n    }\r\n\r\n    // when a create character button is clicked...\r\n    onCreate(){\r\n        // show the character create menu\r\n        NavDispatcher.showCharacterCreate();\r\n    }\r\n\r\n    // when the logout button is clicked...\r\n    onLogout(){\r\n        // send the logout 'request'\r\n        Client.logout();\r\n        // show the login menu\r\n        NavDispatcher.showLogin();\r\n    }\r\n\r\n    selectPlayer(name){\r\n        // lock the UI while awaiting selection response\r\n        this.setState({pending: true});\r\n        // send the character select request \r\n        Client.selectCharacter(name);\r\n    }\r\n\r\n    renderCharacterList(){\r\n        let characterList = this.state.characterList;\r\n\r\n        if(!characterList){\r\n            return <div>{this.state.characterListErrMsg || \"Loading...\"}</div>;\r\n        }\r\n\r\n        let rows = [];\r\n\r\n        for(let i = 0; i < 6; i++){\r\n            let characterData = characterList[i] || null;\r\n\r\n            if(characterData){\r\n                let {name, level, last_map} = characterData;\r\n\r\n                rows.push(\r\n                    <tr key={i}>\r\n                        <td>{name}</td>\r\n                        <td>Level {level}</td>\r\n                        <td>{last_map}</td>\r\n                        <td>\r\n                            <Button\r\n                                width={BUTTON_WIDTH}\r\n                                onClick={() => this.selectPlayer(name)}\r\n                                disabled={this.state.pending}\r\n                            >\r\n                                Select\r\n                            </Button>\r\n                        </td>\r\n                    </tr>\r\n                );\r\n            }\r\n            else{\r\n                rows.push(\r\n                    <tr key={i}>\r\n                        <td>\r\n                            <Button\r\n                                width={BUTTON_WIDTH}\r\n                                onClick={this.onCreate.bind(this)}\r\n                                disabled={this.state.pending}\r\n                            >\r\n                                Create\r\n                            </Button>\r\n                        </td>\r\n                    </tr>\r\n                );\r\n            }\r\n        }\r\n\r\n        // render the table\r\n        return (\r\n            <div>\r\n                <Table>\r\n                    <thead>\r\n                        {rows}\r\n                    </thead>\r\n                </Table>\r\n                {this.renderLogoutBtn()}\r\n            </div>  \r\n        )\r\n    }\r\n\r\n    // renders the logout button\r\n    renderLogoutBtn(){\r\n        return (\r\n            <div className=\"text-center\">\r\n                <Button width={BUTTON_WIDTH} disabled={this.state.pending} onClick={this.onLogout.bind(this)}>\r\n                    Logout\r\n                </Button>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // renders the body (character list or error message)\r\n    renderBody(){\r\n        // extract character list and error message\r\n        let {characterList=null, errMessage=null} = this.state;\r\n\r\n        // if there is an error message - render the error in the body \r\n        if(errMessage){\r\n            return (\r\n                <div>\r\n                    <div>{errMessage}</div>\r\n                    {this.renderLogoutBtn()}\r\n                </div>\r\n            );\r\n        }\r\n\r\n        // if no error and character list - render the character list table\r\n        else if(characterList){\r\n            return this.renderCharacterList();\r\n        }\r\n\r\n        // else - character list is still loading \r\n        return <div>Loading...</div>\r\n    }\r\n\r\n    render(){\r\n        return (\r\n            <div>\r\n                <div className=\"app-menu\">\r\n                    <br/>\r\n                    {this.renderBody()}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}","import React from \"react\";\r\nimport { Form, FormGroup, Label, Input, Button, Row, Col } from \"reactstrap\";\r\nimport { NAME_MAX_LENGTH, BUTTON_WIDTH } from \"../data/Data\";\r\nimport Client from \"../game/Client\";\r\nimport NavDispatcher from \"../dispatchers/NavDispatcher\";\r\nimport ModalDispatcher from \"../dispatchers/ModalDispatcher\";\r\n\r\nexport class CharacterCreate extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n\r\n        this.nameInput = null;  // <input> element for the name\r\n        this.skinInput = null;  // <input> element for the skin (dropdown)\r\n\r\n        this.state = {\r\n            pending: false      // awaiting response (locks UI)\r\n        };\r\n\r\n        // handler for when the client receives a character create response \r\n        this.onCharacterCreate = evt => {\r\n            // got a response \r\n            if(evt.status === \"ok\"){\r\n                // successful response - show the character select menu\r\n                // (will have the new character in its slot)\r\n                NavDispatcher.showMenu(\"character-select\");\r\n            }\r\n            else{\r\n                // failed response\r\n                // display error message\r\n                ModalDispatcher.modal(\"Character Error\", evt.message);\r\n                // unlock UI \r\n                this.setState({pending: false});\r\n            }\r\n        };\r\n    }\r\n\r\n    componentDidMount(){\r\n        // listen for the client to recieve a character create response \r\n        Client.on(\"character-create\", this.onCharacterCreate);\r\n    }\r\n\r\n    componentWillUnmount(){\r\n        // stop listening for the client to recieve a character create response (prevents leak)\r\n        Client.removeListener(\"character-create\", this.onCharacterCreate);\r\n    }\r\n\r\n    // when the click button is clicked\r\n    onCancel(){\r\n        // show the character select menu \r\n        NavDispatcher.showMenu(\"character-select\");\r\n    }\r\n\r\n    // when the form is submitted (enforces 'required' elements)\r\n    onSubmit(evt){\r\n        evt.preventDefault();               // prevent page reload \r\n\r\n        this.setState({pending: true});     // lock the UI\r\n\r\n        let name = this.nameInput.value;    // extract name\r\n        let skin = this.skinInput.value;    // extract skin\r\n\r\n        Client.createCharacter(name, skin); // send the request\r\n    }\r\n\r\n    render(){\r\n        return (\r\n            <div>\r\n                <br/>\r\n                <div className=\"app-menu\">\r\n                    <Form onSubmit={this.onSubmit.bind(this)}>\r\n                        <FormGroup>\r\n                            <Label>Name</Label>\r\n                            <Input\r\n                                innerRef={input => this.nameInput = input}\r\n                                type=\"text\"\r\n                                maxLength={NAME_MAX_LENGTH}\r\n                                disabled={this.state.pending}\r\n                                required\r\n                            />\r\n                        </FormGroup>\r\n                        <FormGroup>\r\n                            <Label>Skin</Label>\r\n                            <Row>\r\n                                <Col lg={6}>\r\n                                    <Input\r\n                                        innerRef={input => this.skinInput = input}\r\n                                        type=\"select\"\r\n                                        disabled={this.state.pending}\r\n                                        required\r\n                                    >\r\n                                        <option value={1}>Human Male</option>\r\n                                        <option value={2}>Human Female</option>\r\n                                    </Input>\r\n                                </Col>\r\n                                <Col lg={6}>\r\n                                    (Preview)\r\n                                </Col>\r\n                            </Row>\r\n                        </FormGroup>\r\n                        <div className=\"text-center\">\r\n                            <Button>\r\n                                Submit\r\n                            </Button>\r\n                            &nbsp;\r\n                            <Button type=\"button\" width={BUTTON_WIDTH} onClick={this.onCancel.bind(this)}>\r\n                                Cancel\r\n                            </Button>\r\n                        </div>\r\n                    </Form>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}","import React from \"react\";\r\nimport Client from \"../game/Client\";\r\n\r\nexport class GameViewChat extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n\r\n        this.displayRef = React.createRef();\r\n        this.inputRef = React.createRef();\r\n\r\n        // handler for when the client receives chat messages \r\n        this.onChatReceived = evt => {\r\n            // must receive a good update \r\n            if(evt.status === \"ok\"){\r\n                // get the chat display <textarea> element\r\n                let elem = this.displayRef.current;\r\n                // formate the new text ('from' might not be provided)\r\n                let text = evt.from ? `${evt.from}: ${evt.chat}` : evt.chat;\r\n\r\n                // upate the <textarea> \r\n                if(elem.value){\r\n                    // put new text underneath old text \r\n                    elem.value += \"\\n\" + text;\r\n                }\r\n                else{\r\n                    // no text - make display text the first chat message\r\n                    elem.value = text;\r\n                }\r\n            }\r\n        };\r\n    }\r\n\r\n    componentDidMount(){\r\n        // listen for the client to get a chat message\r\n        Client.on(\"chat\", this.onChatReceived);\r\n    }\r\n\r\n    componentWillUnmount(){\r\n        // stop listening for the client to get chat messages (prevents leak)\r\n        Client.removeListener(\"chat\", this.onChatReceived);\r\n    }\r\n\r\n    // sends a chat message\r\n    onChatSend(evt){\r\n        // 13 = enter key \r\n        if(evt.keyCode === 13){\r\n            // get the chat message from the DOM\r\n            let chat = this.inputRef.current.value;\r\n            // must have chat to send (pointless to send empty text)\r\n            if(chat){\r\n                // send the chat\r\n                Client.chatMessage(chat);\r\n                // clear the chat input \r\n                this.inputRef.current.value = \"\";\r\n            }\r\n        }\r\n    }\r\n\r\n    render(){\r\n        return (\r\n            <div className=\"hud-chat\">\r\n                <textarea\r\n                    ref={this.displayRef}\r\n                    readOnly\r\n                />\r\n                <br/>\r\n                <input\r\n                    ref={this.inputRef}\r\n                    type=\"text\"\r\n                    maxLength={128}\r\n                    onKeyUp={this.onChatSend.bind(this)}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n}","import React from \"react\";\r\nimport Client from \"../game/Client\";\r\nimport Game from \"../game/Game\";\r\n\r\nexport class GameViewTarget extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n\r\n        this.state = {\r\n            stats: null\r\n        };\r\n\r\n        // handler for when the client gets object stats\r\n        // (this component is the view for target object stats)\r\n        this.onObjectStats = evt => {\r\n            // must still have a selected target and successful response\r\n            if(evt.status === \"ok\" && Game.selectedTarget){\r\n                // extract stats\r\n                let {stats} = evt;\r\n\r\n                // if the stats match up with select target - update the UI \r\n                if(Game.selectedTarget.objectID === stats.objectID){\r\n                    this.setState({stats});\r\n                }\r\n            }\r\n        };\r\n    }\r\n\r\n    componentDidMount(){\r\n        // listen for the client to receive object stats \r\n        Client.on(\"object-stats\", this.onObjectStats);\r\n    }\r\n\r\n    componentWillUnmount(){\r\n        // stop listening for object stats (prevents leak)\r\n        Client.removeListener(\"object-stats\", this.onObjectStats);\r\n    }\r\n\r\n    // renders the stats table (note: different from player stats)\r\n    renderStats(){\r\n        // extract the stats, return nothing if no stats\r\n        let stats = this.state.stats;\r\n        if(!stats) return null;\r\n\r\n        // extract stats values \r\n        // note: base and current are objects, the rest are strings or numbers \r\n        let {base, current, name, team, level=null} = stats;\r\n\r\n        return (\r\n            <table>\r\n                <tbody>\r\n                    <tr className=\"text-center\">\r\n                        <td colSpan={2}>\r\n                            {name} {level ? `(${level})` : null}\r\n                        </td>\r\n                    </tr>\r\n                    <tr className=\"text-center\">\r\n                        <td colSpan={2}>\r\n                            &lt;{team}&gt;\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td>\r\n                            HP\r\n                        </td>\r\n                        <td>\r\n                            {current.health.toFixed(0)} / {base.health.toFixed(0)}\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td>\r\n                            MP\r\n                        </td>\r\n                        <td>\r\n                            {current.mana.toFixed(0)} / {base.mana.toFixed(0)}\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td>\r\n                            DEF\r\n                        </td>\r\n                        <td>\r\n                            {(base.defense * 100).toFixed(0)}%\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td>\r\n                            RES\r\n                        </td>\r\n                        <td>\r\n                            {(base.resistance * 100).toFixed(0)}%\r\n                        </td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        );\r\n    }\r\n\r\n    render(){\r\n        return this.state.stats ? (\r\n            <div className=\"hud-target\">\r\n                {this.renderStats()}\r\n            </div>\r\n        ) : null;\r\n    }\r\n}","import React from \"react\";\r\nimport Client from \"../game/Client\";\r\nimport Game from \"../game/Game\";\r\n\r\nexport class GameViewPlayer extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n\r\n        this.state = {\r\n            stats: null\r\n        };\r\n\r\n        // handler for when the client gets object stats\r\n        // (this component is the view for player object stats)\r\n        this.onObjectStats = evt => {\r\n            // game must have a player and the response be successful \r\n            if(evt.status === \"ok\" && Game.player){\r\n                // extract the stats\r\n                let {stats} = evt;\r\n\r\n                // update the UI if the stats match up with the game player \r\n                if(Game.player.objectID === stats.objectID){\r\n                    this.setState({stats});\r\n                }\r\n            }\r\n        };\r\n    }\r\n\r\n    componentDidMount(){\r\n        // listen for the client to receive object stats \r\n        Client.on(\"object-stats\", this.onObjectStats);\r\n    }\r\n\r\n    componentWillUnmount(){\r\n        // stop listening for object stats (prevents leak)\r\n        Client.removeListener(\"object-stats\", this.onObjectStats);\r\n    }\r\n\r\n    // renders the stats table (note: different from target stats)\r\n    renderStats(){\r\n        // extract the player stats, return nothing if no stats\r\n        let stats = this.state.stats;\r\n        if(!stats) return null;\r\n\r\n        // extract player stats \r\n        let {base, current, level, xp, xpNeeded, name} = stats;\r\n\r\n        return (\r\n            <table>\r\n                <tbody>\r\n                    <tr className=\"text-center\">\r\n                        <td colSpan={2}>\r\n                            {name} - Level {level}\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td>\r\n                            HP\r\n                        </td>\r\n                        <td>\r\n                            {current.health.toFixed(0)} / {base.health.toFixed(0)}\r\n                        </td>\r\n                        \r\n                    </tr>\r\n                    <tr>\r\n                        <td>\r\n                            MP\r\n                        </td>\r\n                        <td>\r\n                            {current.mana.toFixed(0)} / {base.mana.toFixed(0)}\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td>\r\n                            XP\r\n                        </td>\r\n                        <td>\r\n                            {xp.toFixed(0)} / {xpNeeded.toFixed(0)}\r\n                        </td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        );\r\n    }\r\n\r\n    render(){\r\n        return this.state.stats ? (\r\n            <div className=\"hud-player\">\r\n                {this.renderStats()}\r\n            </div>\r\n        ) : null;\r\n    }\r\n}","import React from \"react\";\r\nimport { ABILITY_ICON_SIZE } from \"../data/Data\";\r\nimport Client from \"../game/Client\";\r\nimport Game from \"../game/Game\";\r\n\r\nexport class GameViewAbilities extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n\r\n        this.state = {\r\n            abilityList: null\r\n        };\r\n\r\n        // handler for when the client receives an ability list update\r\n        this.onAbilityList = evt => {\r\n            // must be a successful response\r\n            if(evt.status === \"ok\"){\r\n                // update the UI \r\n                console.log(evt);\r\n                this.setState({abilityList: evt.abilityList});\r\n            }\r\n        };\r\n    }\r\n\r\n    componentDidMount(){\r\n        // listen for the client to receive ability list\r\n        Client.on(\"ability-list\", this.onAbilityList);\r\n    }\r\n\r\n    componentWillUnmount(){\r\n        // stop listening for the client to receive ability list (prevents leak)\r\n        Client.removeListener(\"ability-list\", this.onAbilityList);\r\n    }\r\n\r\n    // renders the ability icons \r\n    renderAbilityList(){\r\n        // current abilities \r\n        let abilityList = this.state.abilityList || [];\r\n        // list of icons to render (there will always be 10 abilities)\r\n        let icons = new Array(10);\r\n        \r\n        // for each icon slot...\r\n        for(let i = 0; i < icons.length; i++){\r\n            // find the corresponding ability\r\n            let ability = abilityList[i] || null;\r\n            // prepare the icon <img>\r\n            let icon = null;\r\n\r\n            // if an ability exists at that position \r\n            if(ability){\r\n                // create an image that can be clicked\r\n                icon = (\r\n                    <img\r\n                        key={i}\r\n                        src={null}\r\n                        width={ABILITY_ICON_SIZE}\r\n                        height={ABILITY_ICON_SIZE}\r\n                        disabled={false}\r\n                        title={ability.abilityName}\r\n                        onClick={() => Game.castAbility(ability.abilityName)}\r\n                    />\r\n                );\r\n            }\r\n            else{\r\n                // create an empty slot image (not interactable)\r\n                icon = (\r\n                    <img\r\n                        key={i}\r\n                        src={null}\r\n                        width={ABILITY_ICON_SIZE}\r\n                        height={ABILITY_ICON_SIZE}\r\n                        disabled={true}\r\n                    />\r\n                );\r\n            }\r\n\r\n            // put the <img> in the current slot\r\n            icons[i] = icon;\r\n        }\r\n\r\n        // split the list into 5x2 tray \r\n        return (\r\n            <div>\r\n                {icons.slice(0, 5)}\r\n                <br/>\r\n                {icons.slice(5, 10)}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    render(){\r\n        return (\r\n            <div className=\"hud-abilities\">\r\n                {this.renderAbilityList()}\r\n            </div>\r\n        );\r\n    }\r\n}","import React from \"react\";\r\nimport { Dropdown, DropdownMenu, DropdownToggle, DropdownItem } from \"reactstrap\";\r\nimport Client from \"../game/Client\";\r\nimport Game from \"../game/Game\";\r\nimport NavDispatcher from \"../dispatchers/NavDispatcher\";\r\nimport ModalDispatcher from \"../dispatchers/ModalDispatcher\";\r\n\r\nexport class GameViewDropdown extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n\r\n        this.state = {\r\n            isOpen: false   // dropdown visible? \r\n        };\r\n\r\n        // handler for when the client receives players in map \r\n        this.onMapPlayers = evt => {\r\n            // dropdown must be active and successful response \r\n            if(evt.status === \"ok\"){\r\n                // display the players \r\n                ModalDispatcher.modal(\r\n                    \"Nearby Players\",\r\n                    Object.keys(evt.players).map(name => `${name} (Level ${evt.players[name]})`).join(\", \")\r\n                );\r\n            }\r\n        }\r\n    }\r\n\r\n    componentDidMount(){\r\n        // listen for the client to get the players in the map\r\n        Client.on(\"map-players\", this.onMapPlayers);\r\n    }\r\n\r\n    componentWillUnmount(){\r\n        // stop listening for the client to get players in the map (prevents leak)\r\n        Client.removeListener(\"map-players\", this.onMapPlayers);\r\n    }\r\n\r\n    // toggles the dropdown \r\n    toggle(){\r\n        this.setState({isOpen: !this.state.isOpen});\r\n    }\r\n\r\n    // when the find players button is clicked...\r\n    onFindPlayers(){\r\n        // request player info\r\n        Client.getMapPlayers();\r\n    }\r\n\r\n    // when the exit button is clicked...\r\n    onExit(){\r\n        // stop the game\r\n        Game.unloadMap();\r\n        // show login menu\r\n        NavDispatcher.showLogin();\r\n        // send logout notification \r\n        Client.logout();\r\n    }\r\n\r\n    // renders special options based on client's access level \r\n    renderAdminItems(){\r\n        return Client.accessLevel > 1 ? [\r\n            <DropdownItem key={0} divider/>,\r\n            <DropdownItem key={1} header>Admin Commands</DropdownItem>,\r\n            <DropdownItem key={2}>Upgrades Menu</DropdownItem>,\r\n            <DropdownItem key={3}>Instances Menu</DropdownItem>\r\n        ] : null;\r\n    }\r\n\r\n    render(){\r\n        return (\r\n            <div className=\"hud-dropdown\">\r\n                <Dropdown isOpen={this.state.isOpen} toggle={this.toggle.bind(this)}>\r\n                    <DropdownToggle caret>\r\n                        Menu\r\n                    </DropdownToggle>\r\n                    <DropdownMenu>\r\n                        <DropdownItem header>Current Map</DropdownItem>\r\n                        <DropdownItem onClick={this.onFindPlayers.bind(this)}>Find Players</DropdownItem>\r\n                        <DropdownItem divider/>\r\n                        <DropdownItem header>Quit</DropdownItem>\r\n                        <DropdownItem onClick={this.onExit.bind(this)}>Exit/Logout</DropdownItem>\r\n                        {this.renderAdminItems()}\r\n                    </DropdownMenu>\r\n                </Dropdown>\r\n            </div>\r\n        )\r\n    }\r\n}","import React from \"react\";\r\nimport \"./GameView.css\";\r\nimport Game from \"../game/Game\";\r\nimport Client from \"../game/Client\";\r\nimport { GameViewChat } from \"./GameViewChat\";\r\nimport { GameViewTarget } from \"./GameViewTarget\";\r\nimport { GameViewPlayer } from \"./GameViewPlayer\";\r\nimport { GameViewAbilities } from \"./GameViewAbilities\";\r\nimport { GameViewDropdown } from \"./GameViewDropdown\";\r\n\r\nexport class GameView extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n\r\n        // ref for the <div> to inject the <canvas> into \r\n        this.containerRef = React.createRef();\r\n\r\n        // handler for when the client receives a create object notification\r\n        this.onObjectCreate = evt => Game.createObject(evt.spawnState);\r\n        // handler for when the client receives a delete object notification\r\n        this.onObjectDelete = evt => Game.removeObject(evt.objectID);\r\n        // handler for when the client receives an update object notification\r\n        this.onObjectUpdate = evt => Game.updateObject(evt.updateState);\r\n    }\r\n\r\n    componentDidMount(){\r\n        // listen for when the client receives an object create notification\r\n        Client.on(\"object-create\", this.onObjectCreate);\r\n        // listen for when the client receives an object delete notification\r\n        Client.on(\"object-delete\", this.onObjectDelete);\r\n        // listen for when the client receives an object update notification\r\n        Client.on(\"object-update\", this.onObjectUpdate);\r\n\r\n        // insert the game <canvas> element into the DOM\r\n        // (not very reactful - but whatever)\r\n        Game.injectInto(this.containerRef.current);\r\n    }\r\n\r\n    componentWillUnmount(){\r\n        // stop listening for client receives an object create notification (prevents leak)\r\n        Client.removeListener(\"object-create\", this.onObjectCreate);\r\n        // stop listening for client receives an object delete notification (prevents leak)\r\n        Client.removeListener(\"object-delete\", this.onObjectDelete);\r\n        // stop listening for client receives an object update notification (prevents leak)\r\n        Client.removeListener(\"object-update\", this.onObjectUpdate);\r\n    }\r\n\r\n    render(){\r\n        return (\r\n            <div>\r\n                <div ref={this.containerRef} className=\"canvas-container\"></div>\r\n                <GameViewChat/>\r\n                <GameViewTarget/>\r\n                <GameViewPlayer/>\r\n                <GameViewAbilities/>\r\n                <GameViewDropdown/>\r\n            </div>\r\n        );\r\n    }\r\n}","import React from \"react\";\r\nimport { Modal, ModalBody, ModalHeader, ModalFooter } from \"reactstrap\";\r\nimport ModalDispatcher from \"../dispatchers/ModalDispatcher\";\r\n\r\nexport class AlertModal extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n\r\n        this.state = {\r\n            isOpen: false,      // visible or not?\r\n            header: null,       // header text\r\n            body: null,         // body text\r\n            footer: null        // footer text\r\n        };\r\n\r\n        // handler for when a display modal is triggered via the modal dispatcher \r\n        this.onModal = evt => {\r\n            // show the modal with the new text data \r\n            this.setState({\r\n                isOpen: true,\r\n                header: evt.header  || null,    // optional\r\n                body:   evt.body    || null,    // optional\r\n                footer: evt.footer  || null     // optional \r\n            })\r\n        };\r\n    }\r\n\r\n    componentWillMount(){\r\n        // listen for display modal triggers\r\n        ModalDispatcher.on(\"modal\", this.onModal);\r\n    }\r\n\r\n    componentWillUnmount(){\r\n        // stop listening for display modal triggers (prevents leak)\r\n        ModalDispatcher.removeListener(\"modal\", this.onModal);\r\n    }\r\n\r\n    // toggles the modal\r\n    toggle(){\r\n        this.setState({isOpen: !this.state.isOpen});\r\n    }\r\n\r\n    render(){\r\n        return (\r\n            <Modal isOpen={this.state.isOpen} toggle={this.toggle.bind(this)}>\r\n                <ModalHeader toggle={this.toggle.bind(this)}>\r\n                    {this.state.header || null}\r\n                </ModalHeader>\r\n                <ModalBody>\r\n                    {this.state.body|| null}\r\n                </ModalBody>\r\n                <ModalFooter>\r\n                    {this.state.footer || null}\r\n                </ModalFooter>\r\n            </Modal>\r\n        );\r\n    }\r\n}","import React from \"react\";\r\nimport \"./App.css\";\r\nimport { Login } from \"./Login\";\r\nimport { Register } from \"./Register\";\r\nimport { CharacterSelect } from \"./CharacterSelect\";\r\nimport { CharacterCreate } from \"./CharacterCreate\";\r\nimport { GameView } from \"./GameView\";\r\nimport { AlertModal } from \"./AlertModal\";\r\nimport Client from \"../game/Client\";\r\nimport NavDispatcher from \"../dispatchers/NavDispatcher\";\r\nimport ModalDispatcher from \"../dispatchers/ModalDispatcher\";\r\n\r\nexport class App extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n\r\n        this.state = {\r\n            menu: \"login\"   // default menu is the login menu\r\n        };\r\n\r\n        // handler for when a menu change is triggered via modal dispatcher \r\n        this.onMenu = evt => this.setState({menu: evt.menu});\r\n\r\n        // handler for when the websocket closes\r\n        this.onClientClose = () => {\r\n            // display connection lost message\r\n            ModalDispatcher.modal(\"Socket Error\", \"Connection error.\");\r\n            // show the login menu\r\n            NavDispatcher.showLogin();\r\n        };\r\n\r\n        // handler for the websocket errors \r\n        this.onClientError = err => {};\r\n    }\r\n\r\n    componentDidMount(){\r\n        // listen for menu change signal from the navigation dispatcher \r\n        NavDispatcher.on(\"menu\", this.onMenu);\r\n        // listen for the websocket to close \r\n        Client.on(\"close\", this.onClientClose);\r\n        // listen for the websocket to error \r\n        Client.on(\"error\", this.onClientError);\r\n    }\r\n\r\n    componentWillUnmount(){\r\n        // stop listening for menu changes (prevents leark)\r\n        NavDispatcher.removeListener(\"menu\", this.onMenu);\r\n        // stop listening for websocket closes (prevents leak)\r\n        Client.removeListener(\"close\", this.onClientClose);\r\n        // stop listening for websocket errors (prevents leak)\r\n        Client.removeListener(\"error\", this.onClientError);\r\n    }\r\n\r\n    // renders the current menu component \r\n    renderMenu(){\r\n        switch(this.state.menu){\r\n            case \"login\":\r\n                return <Login/>\r\n            case \"register\":\r\n                return <Register/>;\r\n            case \"character-select\":\r\n                return <CharacterSelect/>;\r\n            case \"character-create\":\r\n                return <CharacterCreate/>\r\n            case \"game\":\r\n                return <GameView/>;\r\n            default:\r\n                return null;\r\n        }\r\n    }\r\n\r\n    render(){\r\n        return (\r\n            <div>\r\n                {this.renderMenu()}\r\n                <AlertModal/>\r\n            </div>\r\n        );\r\n    }\r\n}","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { App } from \"./components/App\";\r\nimport \"../node_modules/bootstrap/dist/css/bootstrap.min.css\";\r\n\r\nReactDOM.render(<App/>, document.querySelector(\"#root\"));"],"sourceRoot":""}